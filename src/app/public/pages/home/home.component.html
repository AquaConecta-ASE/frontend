<app-header-content></app-header-content>

<!-- Profile Incomplete Warning Banner -->
<div class="profile-warning-banner" *ngIf="showProfileWarning">
  <div class="warning-content">
    <span class="warning-icon">âš ï¸</span>
    <div class="warning-text">
      <strong>{{ translate('complete_your_profile') || 'Complete su perfil' }}</strong>
      <p>{{ translate('profile_incomplete_message') || 'Su perfil fue creado con informaciÃ³n bÃ¡sica. Por favor complete sus datos para una mejor experiencia.' }}</p>
    </div>
    <button class="btn-complete-profile" (click)="goToProfile()">
      {{ translate('complete_profile') || 'Completar Perfil' }}
    </button>
    <button class="btn-close-warning" (click)="closeProfileWarning()">âœ•</button>
  </div>
</div>

<div class="home-container">
  <!-- Welcome Section -->
  <div class="welcome-section">    <div class="welcome-content">
      <h1>{{ translate('welcome') }} <span>{{username || 'Usuario'}}</span></h1>
      <p>{{ translate('water_management_dashboard') }}</p>
    </div>

    <div class="user-profile-section">
      <button class="profile-button" (click)="toggleProfileDropdown()">
        <div class="profile-avatar">{{getUserInitials()}}</div>
        <div class="profile-info">
          <!--
          <p class="profile-name">{{username || 'Usuario'}}</p>
          -->
          <p class="profile-role">{{userRole || 'Provider'}}</p>
        </div>
      </button>      <div class="profile-dropdown" [class.show]="showProfileDropdown">        <a class="dropdown-item" routerLink="/provider/1/profile">
          ğŸ‘¤ {{ translate('view_profile') }}
        </a>        <div class="dropdown-divider"></div>
        <div class="dropdown-item language-selector" (click)="$event.stopPropagation()">
          ğŸŒ {{ translate('language') }}
          <app-language-toggle></app-language-toggle>
        </div>
        <div class="dropdown-divider"></div>
        <a class="dropdown-item logout" (click)="logout()">
          ğŸšª {{ translate('sign_out') }}
        </a>
      </div>
    </div>
  </div>

  <!-- Dashboard Cards -->
  <div class="dashboard-container">
    <div class="dashboard-grid">

      <!-- Water Requests Card -->
      <div class="dashboard-card" routerLink="/requests">        <div class="card-header">
          <div class="card-icon water-requests">ğŸ’§</div>
          <h3 class="card-title">{{ translate('water_requests') }}</h3>
        </div>
        <div class="card-content">
          <div class="card-info">
            <p class="card-description">
              {{ translate('active_water_requests') }}
            </p>
            <div class="status-badge status-pending" *ngIf="!isLoadingWaterRequests">
              {{waterRequestsPending ?? 'â€”'}} {{ translate('pending') }}
            </div>
            <div class="status-badge status-pending" *ngIf="isLoadingWaterRequests">
              <span class="loading-spinner"></span>
              <span>{{ translate('loading') }}</span>
            </div>
            <a class="card-action">{{ translate('view_all_requests') }}</a>
          </div>
          <div class="card-metric">
            <span class="card-number" *ngIf="!isLoadingWaterRequests">{{waterRequestsCount ?? 'â€”'}}</span>
            <span class="card-number" *ngIf="isLoadingWaterRequests">
              <span class="loading-spinner-large"></span>
            </span>
            <span class="card-label">{{ translate('total_requests') }}</span>
          </div>
        </div>
      </div>

      <!-- General Requests Card -->
      <div class="dashboard-card" routerLink="/issue-reports">        <div class="card-header">
          <div class="card-icon general-requests">ğŸ“‹</div>
          <h3 class="card-title">{{ translate('issue_reports') }}</h3>
        </div>
        <div class="card-content">
          <div class="card-info">
            <p class="card-description">
              {{ translate('maintenance_reports') }}
            </p>
            <div class="status-badge status-active" *ngIf="!isLoadingReports">
              {{reportsActive ?? 'â€”'}} {{ translate('active') }}
            </div>
            <div class="status-badge status-active" *ngIf="isLoadingReports">
              <span class="loading-spinner"></span>
              <span>{{ translate('loading') }}</span>
            </div>
            <a class="card-action">{{ translate('view_all_reports') }}</a>
          </div>
          <div class="card-metric">
            <span class="card-number" *ngIf="!isLoadingReports">{{reportsCount ?? 'â€”'}}</span>
            <span class="card-number" *ngIf="isLoadingReports">
              <span class="loading-spinner-large"></span>
            </span>
            <span class="card-label">{{ translate('total_reports') }}</span>
          </div>
        </div>
      </div>

      <!-- Residents Card -->
      <div class="dashboard-card" routerLink="/residents">        <div class="card-header">
          <div class="card-icon residents">ğŸ‘¥</div>
          <h3 class="card-title">{{ translate('residents') }}</h3>
        </div>
        <div class="card-content">
          <div class="card-info">
            <p class="card-description">
              {{ translate('total_residents') }}
            </p>
            <div class="status-badge status-active">{{ translate('active_community') }}</div>
            <a class="card-action">{{ translate('view_residents_list') }}</a>
          </div>
          <div class="card-metric">
            <span class="card-number" *ngIf="!isLoadingResidents">{{residentsCount ?? 'â€”'}}</span>
            <span class="card-number" *ngIf="isLoadingResidents">
              <span class="loading-spinner-large"></span>
            </span>
            <span class="card-label">{{ translate('registered') }}</span>
          </div>
        </div>
      </div>

      <!-- Device Events Card -->
      <div class="dashboard-card" routerLink="/sensor-monitoring">        <div class="card-header">
          <div class="card-icon devices">ğŸ“Š</div>
          <h3 class="card-title">{{ translate('device_monitoring') }}</h3>
        </div>
        <div class="card-content">
          <div class="card-info">
            <p class="card-description">
              {{ translate('device_events_data') }}
            </p>
            <div class="status-badge status-active">{{lastDeviceUpdate || translate('live_data') }}</div>
            <a class="card-action">{{ translate('view_device_history') }}</a>
          </div>
          <div class="card-metric">
            <span class="card-number" *ngIf="!isLoadingDevices">{{deviceEventsCount ?? 'â€”'}}</span>
            <span class="card-number" *ngIf="isLoadingDevices">
              <span class="loading-spinner-large"></span>
            </span>
            <span class="card-label">{{ translate('device_events') }}</span>
          </div>
        </div>
      </div>

      <!-- Predictive Analytics Card -->
      <div class="dashboard-card" routerLink="/predictive-analytics">
        <div class="card-header">
          <div class="card-icon predictive">ğŸ”®</div>
          <h3 class="card-title">Predictive Analytics</h3>
        </div>
        <div class="card-content">
          <div class="card-info">
            <p class="card-description">
              PredicciÃ³n de consumo de agua
            </p>
            <div class="status-badge status-active">AI Powered</div>
            <a class="card-action">Ver predicciones</a>
          </div>
          <div class="card-metric">
            <span class="card-number">ğŸ“ˆ</span>
            <span class="card-label">Machine Learning</span>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Quick Actions
  <div class="buttons-container">
    <button routerLink="/admin/admin-dashboard" class="btn-info">Admin Dashboard</button>
    <button routerLink="/login" class="btn-primary">Sign In</button>
    <button routerLink="/signup" class="btn-secondary">Sign Up</button>
    <button routerLink="/providers" class="btn-info">Providers</button>
    <button routerLink="/provider/1/profile" class="btn-info">Provider Profile</button>
  </div>
  -->
</div>
